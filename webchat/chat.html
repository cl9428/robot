<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Netty å®æ—¶é€šä¿¡</title>
	</head>
	<body>
		å‘é€æ¶ˆæ¯ï¼š<input type="text" id="msgContent" />
		<input type="button" value="å‘é€æ¶ˆæ¯" onclick="CHAT.chat()" />
		<hr />
		æ¥æ”¶æ¶ˆæ¯ï¼š
		<div id="receiveMsg"></div>
		
		<script type="text/javascript">
			window.CHAT = {
				socket: null,
				init:function(){
					//åˆ¤æ–­æµè§ˆå™¨æ˜¯å¦æ”¯æŒwebsocket
					if(window.WebSocket){
						//åˆ›å»ºwebsocket å¯¹è±¡
						CHAT.socket = new WebSocket("ws://cl8080.cn.utools.club/ws");
						CHAT.socket.onopen = function(){
							console.log("é“¾æ¥å»ºç«‹æˆåŠŸ");
						},
						CHAT.socket.close=function(){
							console.log("é“¾æ¥å…³é—­");
						},
						CHAT.socket.onerror = function(){
							console.log("å‘ç”Ÿå¼‚å¸¸");
						},
						CHAT.socket.onmessage = function(e){
							console.log("æ¥å—æ¶ˆæ¯ï¼š"+e.data);
							var receiveMsg = document.getElementById("receiveMsg");
							var html= receiveMsg.innerHTML;//è·å–æœ¬å¯¹è±¡åŸğŸˆ¶ï¸çš„å†…å®¹
							//åµŒå…¥æ–°çš„å†…å®¹
							receiveMsg.innerHTML= html + "<br/>"+e.data;
						}
					}else{
						console.log("æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒwebsocketåè®®");
					}
				},
				chat:function(){
					//è·å–å‘é€æ¶ˆæ¯æ¡†ä¸­æ‰€è¾“å…¥å†…å®¹
					var msgContent = document.getElementById("msgContent").value;
					//å°†å®¢æˆ·è¾“å…¥çš„æ¶ˆæ¯è¿›è¡Œå‘é€
					CHAT.socket.send(msgContent);
					
				}
			};
			CHAT.init();
		</script>
	</body>
</html>
